# 08_ENV_REFERENCE.md - REAL ESTATE SAAS PLATFORM

## Referencia

- `01_frontend_requirements.md`
- `02_backend_appwrite_requirements.md`
- `06_appwrite_functions_catalog.md`

---

## 1. Principios

1. Single source of truth: toda variable debe estar aqui.
2. Una configuracion por instancia cliente.
3. Variables frontend con prefijo `VITE_`.
4. Secrets solo backend/functions.

---

## 2. Variables Core de Instancia

## 2.1 Frontend

```bash
VITE_APP_NAME="Real Estate SaaS"
VITE_APP_ENV=development
VITE_APP_URL=http://localhost:5173
VITE_INSTANCE_MODE=demo
VITE_INSTANCE_SLUG=demo
VITE_INSTANCE_OWNER_NAME=
VITE_ROOT_PANEL_PATH=/__root/activity
```

`VITE_INSTANCE_MODE`: `demo` o `client`.

## 2.2 Backend/Functions

```bash
APP_ENV=development
INSTANCE_MODE=demo
INSTANCE_SLUG=demo
INSTANCE_OWNER_EMAIL=
```

---

## 3. Appwrite Variables

## 3.1 Frontend

```bash
VITE_APPWRITE_ENDPOINT=https://appwrite.racoondevs.com/v1
VITE_APPWRITE_PROJECT_ID=
VITE_APPWRITE_DATABASE_ID=main

VITE_APPWRITE_COLLECTION_USERS_ID=
VITE_APPWRITE_COLLECTION_USER_PREFERENCES_ID=
VITE_APPWRITE_COLLECTION_PROPERTIES_ID=
VITE_APPWRITE_COLLECTION_PROPERTY_IMAGES_ID=
VITE_APPWRITE_COLLECTION_AMENITIES_ID=
VITE_APPWRITE_COLLECTION_PROPERTY_AMENITIES_ID=
VITE_APPWRITE_COLLECTION_LEADS_ID=
VITE_APPWRITE_COLLECTION_RESERVATIONS_ID=
VITE_APPWRITE_COLLECTION_RESERVATION_PAYMENTS_ID=
VITE_APPWRITE_COLLECTION_RESERVATION_VOUCHERS_ID=
VITE_APPWRITE_COLLECTION_REVIEWS_ID=
VITE_APPWRITE_COLLECTION_ANALYTICS_DAILY_ID=
VITE_APPWRITE_COLLECTION_ACTIVITY_LOGS_ID=
VITE_APPWRITE_COLLECTION_EMAIL_VERIFICATIONS_ID=

VITE_APPWRITE_BUCKET_PROPERTY_IMAGES_ID=
VITE_APPWRITE_BUCKET_AVATARS_ID=
VITE_APPWRITE_BUCKET_DOCUMENTS_ID=
```

## 3.2 Functions

```bash
APPWRITE_ENDPOINT=https://appwrite.racoondevs.com/v1
APPWRITE_PROJECT_ID=
APPWRITE_API_KEY=
APPWRITE_DATABASE_ID=main

APPWRITE_COLLECTION_USERS_ID=
APPWRITE_COLLECTION_USER_PREFERENCES_ID=
APPWRITE_COLLECTION_PROPERTIES_ID=
APPWRITE_COLLECTION_LEADS_ID=
APPWRITE_COLLECTION_RESERVATIONS_ID=
APPWRITE_COLLECTION_RESERVATION_PAYMENTS_ID=
APPWRITE_COLLECTION_RESERVATION_VOUCHERS_ID=
APPWRITE_COLLECTION_REVIEWS_ID=
APPWRITE_COLLECTION_ANALYTICS_DAILY_ID=
APPWRITE_COLLECTION_ACTIVITY_LOGS_ID=
APPWRITE_COLLECTION_EMAIL_VERIFICATIONS_ID=
```

---

## 4. Functions IDs (Frontend)

```bash
VITE_APPWRITE_FUNCTION_CREATE_LEAD_ID=
VITE_APPWRITE_FUNCTION_CREATE_RESERVATION_ID=
VITE_APPWRITE_FUNCTION_CREATE_PAYMENT_SESSION_ID=
VITE_APPWRITE_FUNCTION_CREATE_REVIEW_ID=
VITE_APPWRITE_FUNCTION_EMAIL_VERIFICATION_ID=
VITE_APPWRITE_FUNCTION_SYNC_USER_PROFILE_ID=
VITE_APPWRITE_FUNCTION_DASHBOARD_METRICS_ID=
```

---

## 5. SMTP

```bash
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=
SMTP_FROM_NAME="Real Estate SaaS"
```

---

## 6. Stripe y Mercado Pago

## 6.1 Stripe

```bash
STRIPE_SECRET_KEY=
STRIPE_PUBLISHABLE_KEY=
STRIPE_WEBHOOK_SECRET=
```

## 6.2 Mercado Pago

```bash
MERCADOPAGO_ACCESS_TOKEN=
MERCADOPAGO_PUBLIC_KEY=
MERCADOPAGO_WEBHOOK_SECRET=
```

## 6.3 Configuracion comun de pagos

```bash
PAYMENT_DEFAULT_PROVIDER=stripe
PAYMENT_SUCCESS_URL=
PAYMENT_CANCEL_URL=
PAYMENT_WEBHOOK_BASE_URL=
```

---

## 7. Root y Auditoria

```bash
ROOT_BOOTSTRAP_EMAIL=
ROOT_BOOTSTRAP_PASSWORD=
ROOT_PANEL_PATH=/__root/activity
ACTIVITY_LOG_MAX_BEFORE_SIZE=20000
ACTIVITY_LOG_MAX_AFTER_SIZE=20000
```

Reglas:

- Estas variables no se exponen al frontend salvo `VITE_ROOT_PANEL_PATH`.
- Root se crea una vez por provisioning y luego se gestiona fuera del flujo normal.

---

## 8. Branding por Cliente (Base)

```bash
VITE_BRAND_PRIMARY=#0F172A
VITE_BRAND_SECONDARY=#16A34A
VITE_BRAND_FONT_HEADING="Poppins"
VITE_BRAND_FONT_BODY="Inter"
VITE_BRAND_LOGO_URL=
```

---

## 9. Validacion Recomendada

## 9.1 Frontend (`src/env.js`)

```javascript
const required = [
  "VITE_APPWRITE_ENDPOINT",
  "VITE_APPWRITE_PROJECT_ID",
  "VITE_APPWRITE_DATABASE_ID",
  "VITE_APPWRITE_COLLECTION_PROPERTIES_ID",
  "VITE_APPWRITE_COLLECTION_RESERVATIONS_ID",
];
```

## 9.2 Functions

```javascript
validateEnv([
  "APPWRITE_ENDPOINT",
  "APPWRITE_PROJECT_ID",
  "APPWRITE_API_KEY",
  "APPWRITE_DATABASE_ID",
]);
```

---

## 10. Seguridad

Nunca commitear:

- `.env`
- `.env.local`
- `.env.production`

Siempre commitear:

- `.env.example` sin valores reales.

Buenas practicas:

- API key por function.
- Scope minimo.
- Rotacion de secrets cada 6 meses.

---

## 11. Plantilla de `.env.example` (Frontend)

```bash
VITE_APP_NAME="Real Estate SaaS"
VITE_APP_ENV=development
VITE_APP_URL=http://localhost:5173
VITE_INSTANCE_MODE=demo
VITE_INSTANCE_SLUG=demo
VITE_ROOT_PANEL_PATH=/__root/activity

VITE_APPWRITE_ENDPOINT=https://appwrite.racoondevs.com/v1
VITE_APPWRITE_PROJECT_ID=
VITE_APPWRITE_DATABASE_ID=main

VITE_APPWRITE_COLLECTION_USERS_ID=
VITE_APPWRITE_COLLECTION_PROPERTIES_ID=
VITE_APPWRITE_COLLECTION_LEADS_ID=
VITE_APPWRITE_COLLECTION_RESERVATIONS_ID=
VITE_APPWRITE_COLLECTION_RESERVATION_PAYMENTS_ID=
VITE_APPWRITE_COLLECTION_RESERVATION_VOUCHERS_ID=
VITE_APPWRITE_COLLECTION_REVIEWS_ID=
VITE_APPWRITE_COLLECTION_ACTIVITY_LOGS_ID=

VITE_APPWRITE_FUNCTION_CREATE_LEAD_ID=
VITE_APPWRITE_FUNCTION_CREATE_RESERVATION_ID=
VITE_APPWRITE_FUNCTION_CREATE_PAYMENT_SESSION_ID=

VITE_BRAND_PRIMARY=#0F172A
VITE_BRAND_SECONDARY=#16A34A
```

---

## 12. Estado del Documento

- Definitivo para variables del modelo por instancia dedicada.
- Incluye preparacion de pagos, reservas, voucher y auditoria root.

---

Ultima actualizacion: 2026-02-10
Version: 2.0.0
